name: classical_networking_workflow
displayname: STUFF
Views:
-   name: Files Summary
    displayname: Files Summary
    viewname: filesummary
    displaytype: datatable
    parameters:
        filename: nf_output/summaryresult.tsv
        columns:
            -   title: "Visualize"
                data: 
            -   title: "Filename"
                data: "Filename"
            -   title: "Vendor"
                data: "Vendor"
            -   title: "Model"
                data: "Model"
            -   title: "MS1s"
                data: "MS1s"
            -   title: "MS2s"
                data: "MS2s"
        columnDefs: '[ {"targets": 0,"data": null,"render": function ( data, type, row, meta ) {
        return `
            <a target="_blank" href="https://dashboard.gnps2.org/?usi=mzspec:GNPS2:TASK-${task}-input_spectra/${row["Filename"]}">View LCMS Run</a>
        `;}}]'

-   name: Cluster Summary
    displayname: Cluster Summary
    viewname: clustersummary
    displaytype: datatable_serverbig
    parameters:
        filename: nf_output/networking/clustersummary_with_network.tsv
        columns:
            -   title: "View"
                data: 
            -   title: "Cluster"
                data: "cluster index"
            -   title: "Parent mass"
                data: "parent mass"
            -   title: "# spectra"
                data: "number of spectra"
        columnDefs: '[ {"targets": 0,"data": null,"render": function ( data, type, row, meta ) {
        return `
            <a target="_blank" href="https://metabolomics-usi.gnps2.org/dashinterface/?usi1=mzspec:GNPS2:TASK-${task}-nf_output/clustering/specs_ms.mgf:scan:${row["cluster index"]}">View Spectrum</a>
        `;}}]'

-   name: Library Match Results
    displayname: Library Match Results
    viewname: librarymatches
    displaytype: datatable_serverbig
    parameters:
        filename: nf_output/library/merged_results_with_gnps.tsv
        columns:
            -   title: "View"
                data: 
            -   title: "#Scan#"
                data: "#Scan#"
            -   title: "Compound_Name"
                data: "Compound_Name"
            -   title: "Ion"
                data: Ion_Source
            -   title: "Precursor m/z"
                data: Precursor_MZ
            -   title: "Cosine"
                data: MQScore
            -   title: "Shared Peaks"
                data: SharedPeaks
            -   title: "MassDiff"
                data: MassDiff
            -   title: "SpectrumID"
                data: SpectrumID
        columnDefs: '[ {"targets": 0,"data": null,"render": function ( data, type, row, meta ) {
        return `
            <a target="_blank" href="https://metabolomics-usi.gnps2.org/dashinterface/?usi1=mzspec:GNPS2:TASK-${task}-nf_output/clustering/specs_ms.mgf:scan:${row["#Scan#"]}&usi2=mzspec:GNPS:GNPS-LIBRARY:accession:${row["SpectrumID"]}">View Mirror</a>
        `;}}]'

-   name: Raw Spectra List
    displayname: Raw Spectra List
    viewname: rawspectra
    displaytype: datatable_serverbig
    parameters:
        filename: nf_output/clustering/clusterinfo.tsv
        columns:
            -   title: "View"
                data: 
            -   title: "Cluster"
                data: "#ClusterIdx"
            -   title: "Filename"
                data: "#Filename"
            -   title: "Scan"
                data: "#Scan"
            -   title: "Parent Mass"
                data: "#ParentMass"
            -   title: "RT"
                data: "#RetTime"
        columnDefs: '[ {"targets": 0,"data": null,"render": function ( data, type, row, meta ) {
        return `
            <a target="_blank" href="https://metabolomics-usi.gnps2.org/dashinterface/?usi1=mzspec:GNPS2:TASK-${task}-input_spectra/${row["#Filename"]}:scan:${row["#Scan"]}">View Original Spectrum</a>
            <br>
            <a target="_blank" href="https://metabolomics-usi.gnps2.org/dashinterface/?usi1=mzspec:GNPS2:TASK-${task}-input_spectra/${row["#Filename"]}:scan:${row["#Scan"]}&usi2=mzspec:GNPS2:TASK-${task}-nf_output/clustering/specs_ms.mgf:scan:${row["#ClusterIdx"]}">View Mirror</a>
        `;}}]'


-   name: Network Pairs List
    displayname: Network Pairs List
    viewname: pairslist
    displaytype: datatable_serverbig
    parameters:
        filename: nf_output/networking/pairs_with_components.tsv
        columns:
            -   title: "View"
                data: 
            -   title: "CLUSTERID1"
                data: CLUSTERID1
            -   title: "CLUSTERID2"
                data: CLUSTERID2
            -   title: "DeltaMZ"
                data: DeltaMZ
            -   title: "Cosine"
                data: Cosine
            -   title: "MatchedPeaks"
                data: MatchedPeaks
            -   title: "ComponentIndex"
                data: ComponentIndex
        columnDefs: '[ {"targets": 0,"data": null,"render": function ( data, type, row, meta ) {
        return `
            <a target="_blank" href="https://metabolomics-usi.gnps2.org/dashinterface/?usi1=mzspec:GNPS2:TASK-${task}-nf_output/clustering/specs_ms.mgf:scan:${row["CLUSTERID1"]}&usi2=mzspec:GNPS2:TASK-${task}-nf_output/clustering/specs_ms.mgf:scan:${row["CLUSTERID2"]}">View Mirror</a>
        `;}}]'
                
-   name: section
    displayname: Network Visualizations
    viewname: section
    displaytype: section

-   name: Visualize Network in Browser
    displayname: Visualize Full Network in Browser
    viewname: visualizefullnetwork
    displaytype: linkout
    parameters:
        baseurl: /dashboards/networkviewer
        urlparam:
            -   usi:mzdata:OMETATASK-[task]:nf_output/networking/network.graphml
            -   usi-mgf:mzdata:OMETATASK-[task]:nf_output/clustering/specs_ms.mgf

-   name: Export Network in Cytoscape
    displayname: Export Network in Cytoscape
    viewname: visualizecytoscape
    displaytype: linkout
    parameters:
        baseurl: https://cytoscape.gnps2.org/process
        urlparam:
            -   task:[task]

-   name: section
    displayname: Download Network Files
    viewname: section
    displaytype: section

-   name: Download Network GraphML
    displayname: Download Network GraphML
    viewname: graphml
    displaytype: download
    parameters:
        filename: nf_output/networking/network.graphml

-   name: Download Consensus MS/MS MGF
    displayname: Download Consensus MS/MS MGF
    viewname: specms
    displaytype: download
    parameters:
        filename: nf_output/clustering/specs_ms.mgf
