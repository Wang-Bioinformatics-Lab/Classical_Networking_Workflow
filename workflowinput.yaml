workflowname: classical_networking_workflow
workflowdescription: This is Classical Molecular Networking for GNPS2
workflowlongdescription: This is Classical Molecular Networking for GNPS2
workflowversion: "2026.01.13"
workflowfile: nf_workflow.nf
workflowautohide: false
adminonly: false
#This maps the parameters from an input form to those that will appear in nextflow
parameterlist:
    - displayname: File Selection
      paramtype: section

    - displayname: Input Data Folder
      paramtype: fileselector
      nf_paramname: input_spectra
      formplaceholder: Enter the path to data
      formvalue: ""
      targettaskfolder: input_spectra
      optional: false
      selectsinglefile: false
      folderunroll: true

    - displayname: USI Files to Analyze
      paramtype: textarea
      nf_paramname: usi
      formplaceholder: Enter USIs
      formvalue: ""
      rows: 4
      cols: 50

    - displayname: Input Spectral Library Folder
      paramtype: fileselector
      nf_paramname: input_libraries
      formplaceholder: Enter the path to input_libraries
      formvalue: "LIBRARYLOCATION/LC/LIBRARY"
      targettaskfolder: input_libraries
      optional: false
      selectsinglefile: false
      folderunroll: true
    
    - displayname: Input Metadata File
      paramtype: fileselector
      nf_paramname: metadata_filename
      formplaceholder: Enter the path to metadata_filename
      formvalue: ""
      targettaskfolder: metadata_filename
      optional: true
      selectsinglefile: true
      folderunroll: true
    
    - displayname: Integrate ReDU Metadata for Public USIs
      paramtype: select
      nf_paramname: redu_metadata_integration
      formvalue: "No"
      options:
        - value: "Yes"
          display: "Yes"
        - value: "No"
          display: "No"

    - displayname: Treat Single Files as a Group
      paramtype: select
      nf_paramname: metadata_per_file_grouping
      formvalue: "No"
      options:
        - value: "Yes"
          display: "Yes"
        - value: "No"
          display: "No"

    - displayname: General Parameters
      paramtype: section

    - displayname: Precursor Ion Tolerance
      paramtype: text
      nf_paramname: pm_tolerance
      formplaceholder: Enter the pm_tolerance
      formvalue: "2.0"
      tooltip: "pm_tolerance"

    - displayname: Fragment Ion Tolerance
      paramtype: text
      nf_paramname: fragment_tolerance
      formplaceholder: Enter the fragment_tolerance
      formvalue: "0.5"
      tooltip: "fragment_tolerance"

    - displayname: Clustering Parameters
      paramtype: section
    
    - displayname: Clustering Tool
      paramtype: select
      nf_paramname: clustering_tool
      formvalue: "mscluster"
      options:
        - value: "mscluster"
          display: "MSCluster"
        - value: "falcon"
          display: "Falcon"
      tooltip: "Select the clustering tool to use for spectral clustering"
    
    - displayname: Minimum Cluster Size (Or Disable Clustering)
      paramtype: select
      nf_paramname: min_cluster_size
      formvalue: "2"
      options:
        - value: "0"
          display: "Clustering Off"
        - value: "1"
          display: "1"
        - value: "2"
          display: "2"
        - value: "3"
          display: "3"
        - value: "4"
          display: "4"
        - value: "5"
          display: "5"
    
    - displayname: Falcon Parameters
      paramtype: section
      showif:
        - condition:
          - key: clustering_tool
            value: "falcon"
    
    - displayname: Precursor Ion Tolerance
      paramtype: text
      nf_paramname: falcon_pm_tolerance
      formplaceholder: Enter the pm_tolerance (e.g., 20 ppm or 2.0 Da)
      formvalue: "20 ppm"
      tooltip: "Precursor tolerance with unit (e.g., 20 ppm or 2.0 Da)"
      showif:
        - condition:
          - key: clustering_tool
            value: "falcon"
    
    - displayname: Fragment Ion Tolerance
      paramtype: text
      nf_paramname: falcon_fragment_tolerance
      formplaceholder: Enter the fragment_tolerance
      formvalue: "0.05"
      tooltip: "Fragment tolerance (Da)"
      showif:
        - condition:
          - key: clustering_tool
            value: "falcon"
    
    - displayname: Falcon Epsilon (eps)
      paramtype: text
      nf_paramname: falcon_eps
      formplaceholder: Enter the falcon_eps
      formvalue: "0.1"
      tooltip: "Falcon clustering epsilon parameter (only used when clustering_tool is falcon)"
      showif:
        - condition:
          - key: clustering_tool
            value: "falcon"
    
    - displayname: Falcon Min MZ
      paramtype: text
      nf_paramname: falcon_min_mz
      formplaceholder: Enter the falcon_min_mz
      formvalue: "0"
      tooltip: "Falcon minimum m/z value (only used when clustering_tool is falcon)"
      showif:
        - condition:
          - key: clustering_tool
            value: "falcon"
    
    - displayname: Falcon Max MZ
      paramtype: text
      nf_paramname: falcon_max_mz
      formplaceholder: Enter the falcon_max_mz
      formvalue: "30000"
      tooltip: "Falcon maximum m/z value (only used when clustering_tool is falcon)"
      showif:
        - condition:
          - key: clustering_tool
            value: "falcon"

    - displayname: Clustering Tool
      paramtype: select
      nf_paramname: cluster_method
      formvalue: "MS-Cluster"
      options:
        - value: "MS-Cluster"
          display: "MS-Cluster"
        - value: "Falcon"
          display: "Falcon"

    - displayname: Advanced Filtering Parameters
      paramtype: section

    - displayname: Min Peak Intensity
      paramtype: text
      nf_paramname: min_peak_intensity
      formplaceholder: Enter the min_peak_intensity
      formvalue: "0.0"
      tooltip: "min_peak_intensity"
    
    - displayname: Window Filter
      paramtype: select
      nf_paramname: window_filter
      formvalue: "1"
      options:
        - value: "1"
          display: "yes"
        - value: "0"
          display: "no"

    - displayname: Precursor Window Filter
      paramtype: select
      nf_paramname: precursor_filter
      formvalue: "1"
      options:
        - value: "1"
          display: "yes"
        - value: "0"
          display: "no"
      
    - displayname: MassQL Filtering (EXPERIMENTAL)
      paramtype: text
      nf_paramname: massql_filter
      formplaceholder: Enter the massql_filter
      formvalue: "None"
      tooltip: "This MassQL statement will filter the data before molecular networking scoring"

    - displayname: Networking Parameters
      paramtype: section

    - displayname: min_cosine
      paramtype: text
      nf_paramname: networking_min_cosine
      formplaceholder: Enter the min_cosine
      formvalue: "0.7"

    - displayname: min_matched_peaks
      paramtype: text
      nf_paramname: networking_min_matched_peaks
      formplaceholder: Enter the min_matched_peaks
      formvalue: "6"

    - displayname: networking_max_shift
      paramtype: text
      nf_paramname: networking_max_shift
      formplaceholder: Enter the networking_max_shift
      formvalue: "1999"

    - displayname: Similarity Mode
      paramtype: select
      nf_paramname: similarity
      formvalue: "gnps"
      options:
        - value: "gnps"
          display: "GNPS"
        - value: "index"
          display: "GNPS_Index1"

    - displayname: Network Topology Parameters
      paramtype: section

    - displayname: Classic Param - Top K
      paramtype: text
      nf_paramname: topology_topk
      formplaceholder: Enter the topology_topk
      formvalue: "10"

    - displayname: Classic Param - Max Component Size
      paramtype: text
      nf_paramname: topology_maxcomponent
      formplaceholder: Enter the topology_maxcomponent
      formvalue: "100"

    - displayname: Library Search Parameters
      paramtype: section

    - displayname: Library Minimum Cosine
      paramtype: text
      nf_paramname: library_min_cosine
      formplaceholder: Enter the library_min_cosine
      formvalue: "0.7"

    - displayname: Library Minimum Matched Peaks
      paramtype: text
      nf_paramname: library_min_matched_peaks
      formplaceholder: Enter the library_min_matched_peaks
      formvalue: "6"

    # Analog Search
    - displayname: Analog Search
      paramtype: select
      nf_paramname: library_analog_search
      formvalue: "0"
      options:
        - value: "0"
          display: "No"
        - value: "1"
          display: "Yes"

    - displayname: Top-K
      paramtype: text
      nf_paramname: library_topk
      formplaceholder: Enter the topk
      formvalue: "1"

    

    



